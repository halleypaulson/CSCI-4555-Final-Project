---
title: "Theory Project"
author: "Halley Paulson and Machi Iwata"
date: "4/18/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(keras)
```

#Data
This data has features pertaining to wine measurements to determine quality.
Entries: 4898
Features: 12
1 - fixed acidity: most acids involved with wine or fixed or nonvolatile (do not evaporate readily)
2 - volatile acidity: the amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste
3 - citric acid: found in small quantities, citric acid can add ‘freshness’ and flavor to wines
4 - residual sugar: the amount of sugar remaining after fermentation stops, it’s rare to find wines with less than 1 gram/liter and wines with greater than 45 grams/liter are considered sweet
5 - chlorides: the amount of salt in the wine
6 - free sulfur dioxide: the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth and the oxidation of wine
7 - total sulfur dioxide: amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine
8 - density: the density of water is close to that of water depending on the percent alcohol and sugar content
9 - pH: describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale
10 - sulfates: a wine additive which can contribute to sulfur dioxide gas (S02) levels, which acts as an antimicrobial and antioxidant
11 - alcohol: the percent alcohol content of the wine
12 - quality (score between 0 and 10): based on sensory data
```{r}
#Links:
  #https://archive.ics.uci.edu/ml/datasets/wine+quality
  #https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/

#red_wine = read.csv('wine_data/winequality-red.csv', sep=';')
white_wine = read.csv('wine_data/winequality-white.csv', sep=';')

```

##Preprocessing
```{r}
wine_data = subset(white_wine, select = -c(fixed.acidity,chlorides,free.sulfur.dioxide,density))

```

##Splitting into Training and Testing
```{r}
sample_size = 3918 #80% of full set for training, 20% for testing
set.seed(4898)

tmp = sample(seq_len(nrow(wine_data)),size = sample_size)
training = wine_data[tmp,]
testing = wine_data[-tmp,]

training_data = subset(training, select = -c(quality))
training_labels = subset(training, select = c(quality))

testing_data = subset(testing, select = -c(quality))
testing_labels = subset(testing, select = c(quality))

summary(training_labels)
summary(training_data)
```

#Building the model
```{r}
model = keras_model_sequential() %>%
  layer_dense(units = 50, activation = "relu", input_shape = ncol(training_data)) %>%
  layer_dense(units = 50, activation = "relu") %>%
  layer_dense(units = ncol(training_labels), activation = "linear")

model %>% compile(
  loss = 'mse',
  optimizer = 'adam',
  metrics = c("accuracy")
)
#summary(model)
```

```{r}
#I don't get what's wrong with this
model %>% 
  fit(
    x = as.matrix(training_data),
    y = training_labels,
    epochs = 10,
  )

```

## Evaluating the model
```{r}
model %>% evaluate(testing_data, testing_labels)

# Predicting likelihood of all categories:
result <- model %>% predict(testing_data)

result
```







